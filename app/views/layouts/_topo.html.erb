<div class="fixed top-0 left-0 right-0 bg-white shadow-md z-50">
  <div class="container mx-auto px-4">
    <div class="flex justify-between items-center h-16">
      <!-- Botão Mobile (Hamburger) - Melhoria 2: Acessibilidade -->
      <button class="md:hidden p-2" data-action="click->navbar#toggle" aria-label="Menu" aria-expanded="false">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>

      <!-- Logo -->
      <div class="flex-shrink-0">
        <%= link_to root_url, aria: { label: "Página inicial" } do %>
          <%= image_tag("escudo-mini.png", class: "h-8 w-auto block", alt: "Logo do site") %>
        <% end %>
      </div>

      <!-- Menu Principal (Desktop) -->
      <div class="hidden md:flex space-x-1">
        <ul class="flex items-center space-x-1">
          <%= nav_link_to root_url, class: "px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-100 flex items-center" do %>
            <span class="mr-1" aria-hidden="true">🏠</span>
            <span class="sr-only">Home</span>
          <% end %>

          <% if @bolao_atual %>
            <li class="relative group">
              <%= link_to [@bolao_atual, @rodada_atual], class: "px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-100 flex items-center" do %>
                <span class="mr-1" aria-hidden="true">🏆</span>
                <%= @bolao_atual.titulo.upcase.split(' ')[0,2].join(' ') %>
              <% end %>
              
              <!-- Submenu Dropdown - Melhoria 4: Efeitos de transição -->
              <ul class="absolute hidden group-hover:block bg-white shadow-lg rounded-md py-1 min-w-[200px] z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform group-hover:translate-y-0 -translate-y-2">
                <li><%= link_to 'ÚLTIMA RODADA', [@bolao_atual, @rodada_atual], class: "block px-4 py-2 hover:bg-gray-100" %></li>
                <li><%= link_to 'RODADAS', bolao_rodadas_path(@bolao_atual), class: "block px-4 py-2 hover:bg-gray-100" %></li>
                <li><%= link_to 'TODOS BOLÕES', bolaos_path, class: "block px-4 py-2 hover:bg-gray-100" %></li>
              </ul>
            </li>
          <% else %>
            <%= nav_link_to bolaos_path, class: "px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-100 flex items-center" do %>
              <span class="mr-1" aria-hidden="true">🏆</span> TODOS BOLÕES
            <% end %>
          <% end %>

          <%= nav_link_to posts_path, class: "px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-100 flex items-center" do %>
            <span class="mr-1" aria-hidden="true">💻</span> BLOG
          <% end %>

          <%= nav_link_to albums_path, class: "px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-100 flex items-center" do %>
            <span class="mr-1" aria-hidden="true">📷</span> FOTOS
          <% end %>

          <% if user_signed_in? %>
            <%= link_to "/regulamentoSCA.pdf", target: "_blank", rel: "noopener noreferrer", class: "px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-100 flex items-center" do %>
              <span class="mr-1" aria-hidden="true">📖</span> REGULAMENTO
            <% end %>
            
            <%= nav_link_to new_contato_path, class: "px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-100 flex items-center" do %>
              <span class="mr-1" aria-hidden="true">✉️</span> CONTATO
            <% end %>
          <% end %>

          <% if signed_in? %>
            <%= render 'users/menu' %>
            <%= render 'users/admin_menu' if admin? %>
          <% else %>
            <%= render 'layouts/login' %>
            <%= link_to new_contato_path(request: true), class: "px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-100 flex items-center" do %>
              Solicite Cadastro <span class="ml-1" aria-hidden="true">✏️</span>
            <% end %>
          <% end %>
        </ul>
      </div>

      <!-- Menu do Usuário - Melhoria 4: Efeitos de transição -->
      <div class="flex items-center">
        <% if signed_in? %>
          <div class="relative group ml-4">
            <button class="flex items-center space-x-2 focus:outline-none" aria-label="Menu do usuário" aria-expanded="false">
              <div class="w-8 h-8 rounded-full overflow-hidden">
                <%= image_tag(current_user.avatar? ? current_user.avatar.thumb.url : no_image_url, 
                    class: "w-full h-full object-cover", 
                    alt: "Avatar do usuário") %>
              </div>
            </button>
            
            <!-- Dropdown Menu -->
            <div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform group-hover:translate-y-0 -translate-y-2">
              <%= render 'users/nav_dropmenu' %>
            </div>
          </div>
        <% end %>

        <button class="ml-4 p-2 rounded-full bg-gray-100 hover:bg-gray-200" aria-label="Ajuda">
          <span class="text-gray-700">?</span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Banner Topo - Melhoria 3: Efeito de loading melhorado -->
<div class="relative bg-gray-100 w-full h-64 overflow-hidden">
  <%#= image_tag(@bolao_atual.image.url, class: "w-full h-full object-cover") if @bolao_atual&.image&.present? %>
  
  <div class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-20">
    <div class="relative">
      <%= image_tag("spinner.png", 
            class: "absolute inset-0 w-full h-full animate-spin duration-1000", 
            alt: "", 
            aria: { hidden: "true" }) %>
      <%= image_tag("escudo.png", 
            class: "relative z-10 w-32 h-32 drop-shadow-lg", 
            alt: "Escudo do clube", 
            loading: "lazy") %>
    </div>
  </div>
</div>